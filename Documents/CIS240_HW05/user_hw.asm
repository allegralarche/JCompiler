	.DATA
	.ADDR x4000

name_array
	.STRINGZ "Allegra"

	.ADDR x4200
cross_array
	.FILL #16
	.ADDR x4201
	.FILL #16
	.ADDR x4202
	.FILL #16
	.ADDR x4203
	.FILL #254
	.ADDR x4204
	.FILL #16
	.ADDR x4205
	.FILL #16
	.ADDR x4206
	.FILL #16
	.ADDR x4207
	.FILL #0

	.ADDR x4210
p_array
	.FILL #240
	.ADDR x4211
	.FILL #136
	.ADDR x4212
	.FILL #132
	.ADDR x4213
	.FILL #136
	.ADDR x4214
	.FILL #240
	.ADDR x4215
	.FILL #128
	.ADDR x4216
	.FILL #128
	.ADDR x4217
	.FILL #128

	COUNT_ADDR .CONST x4300


	.CODE
	.ADDR x0000



LOOP
	TRAP x09
	CONST R1, #97
	CMP R5, R1
	BRnp RED
	LEA R0, name_array
	TRAP x08

;;; R4 is color
RED
	CMPI R5, x72
	BRnp GREEN
	CONST R4, x7C00

GREEN
	CMPI R5, x67
	BRnp BLUE
	CONST R4, x03E0

BLUE 
	CMPI R5, x62
	BRnp RECT
	CONST R4, x001F

RECT
	CMPI R5, x68
	BRnp CROSS
	CONST R2, #20
	CONST R3, #40
	CONST R0, #60
	CONST R1, #80
	TRAP x0A

CROSS
	CMPI R5, x2B
	BRnp P
	CONST R0, #60
	CONST R1, #58
	CONST R2, xFC00
	LEA R3, cross_array
	TRAP x0B
P
	CMPI R5, x50
	BRnp TIMER
	CONST R0, #110
	CONST R1, #110
	CONST R2, x7FE0
	LEA R3, p_array
	TRAP x0B
TIMER
	CMPI R5, #0
	BRnp END
	LC R1, COUNT_ADDR
	LDR R0, R1, #0
	ADD R0, R0, #1
	CONST R2, #20
	MOD R0, R0, R2
	STR R0, R1, #0
	CMPI R0, #10
	BRzp NOT_RED
	CONST R4, x7C00
	JMP NOT_GREEN
NOT_RED
	CONST R4, x03E0
NOT_GREEN
	CONST R0, #80
	CONST R1, #10
	CONST R2, #50
	CONST R3, #30
	TRAP x0A


END
BRnzp LOOP



