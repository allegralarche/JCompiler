	.DATA
	.ADDR x4000

name_array
	.STRINGZ "Allegra"

	.ADDR x4200
cross_array
	.FILL x0010
	.ADDR x4201
	.FILL x0010
	.ADDR x4202
	.FILL x0010
	.ADDR x4203
	.FILL x00FE
	.ADDR x4204
	.FILL x0010
	.ADDR x4205
	.FILL x0010
	.ADDR x4206
	.FILL x0010
	.ADDR x4207
	.FILL x0000

	.ADDR x4210
p_array
	.FILL x00F0
	.ADDR x4211
	.FILL x0088
	.ADDR x4212
	.FILL x0084
	.ADDR x4213
	.FILL x0088
	.ADDR x4214
	.FILL x00F0
	.ADDR x4215
	.FILL x0080
	.ADDR x4216
	.FILL x0080
	.ADDR x4217
	.FILL x0080

	COUNT_ADDR .CONST x4300

	RED_CODE   .UCONST x7C00	; 0 11111 00000 00000
	GREEN_CODE .UCONST x03E0	; 0 00000 11111 00000
	BLUE_CODE  .UCONST x001F	; 0 00000 00000 11111
	YELLOW_CODE .UCONST x7FE0   ; 0 11111 11111 00000


	.CODE
	.ADDR x0000



LOOP
	TRAP x09
	CONST R1, #97
	CMP R5, R1
	BRnp RED ;; is zero positive? should this just be BRn?
	LEA R0, name_array
	TRAP x08

;;; R4 is color
RED
	CONST R1, #114
	CMP R5, R1
	BRnp GREEN
	LC R4, RED_CODE

GREEN
	CONST R1, #103
	CMP R5, R1
	BRnp BLUE
	LC R4, GREEN_CODE

BLUE 
	CONST R1, #98
	CMP R5, R1
	BRnp RECT
	LC R4, BLUE_CODE

RECT
	CONST R1, #104
	CMP R5, R1
	BRnp CROSS
	CONST R2, #20
	CONST R3, #40
	CONST R0, #60
	CONST R1, #80
	TRAP x0A

CROSS
	CMPI R5, x2B
	BRnp P
	CONST R0, #60
	CONST R1, #58
	LC R2, RED_CODE
	LEA R3, cross_array
	TRAP x0B
P
	CONST R1, x50
	CMP R5, R1
	BRnp TIMER
	CONST R0, #110
	CONST R1, #110
	LC R2, YELLOW_CODE
	LEA R3, p_array
	TRAP x0B
TIMER
	CMPI R5, #0
	BRnp END
	LC R1, COUNT_ADDR
	LDR R0, R1, #0
	ADD R0, R0, #1
	CONST R2, #20
	MOD R0, R0, R2
	STR R0, R1, #0
	CMPI R0, #10
	BRzp NOT_RED
	LC R4, RED_CODE
	JMP NOT_GREEN
NOT_RED
	LC R4, GREEN_CODE
NOT_GREEN
	CONST R0, #80
	CONST R1, #10
	CONST R2, #50
	CONST R3, #30
	TRAP x0A


END
BRnzp LOOP



